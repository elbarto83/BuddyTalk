<!doctype html>
<html>
  <head>
    <title>BuddyTalk</title>

    <style type="text/css">
      
      .input-block {
        display: block;
      }

      .chat-block {
        display: none;
      }
      input {
        outline: 0;
        padding: 2px 5px;
      }
      input:focus {
        outline: 0;
        border: 1px solid #333;

      }
    </style>
  </head>
  <body>
    

    <div class="input-block">
      <input type="text" id='username' placeholder="User name please ">
    </div> 

    <div class="chat-block">
        <p>----------------------------------Message Board---------------------------------</p>
        <ul id="messages"></ul>

        <p>--------------------------------------Users-------------------------------------</p>
        <ul id="clients"></ul>

        <p>--------------------------------------Rooms-------------------------------------</p>
        <ul id="rooms"></ul>
        Room create/join/leave:
        
          <input id="room" autocomplete="off"/>
          <button id="createBtn">Create</button>
          <button>Join</button>
          <button>Leave</button>
        

        <p>---------------------------------Send your message------------------------------</p>
        <input type="text" id='recipient_user' placeholder="User name please ">
        <input type="text" id='recipient_room' placeholder="Room name please ">

        <form action="#">
          <input id="m" autocomplete="off"/>
          <button>Send</button>
        </form>
        
    </div>

    

    <script src="/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
      /* jquery */
      var username = '';
      var socket;

      $("#username").keydown(function(event){
       if(event.which == 13) {
          $('.chat-block').show();
          $('.input-block').hide();
          username = $('#username').val();
          socket = io();
          socket.emit('join', { email: username });

          //event listeners
          socket.on('join', function (msg) {
            $('#clients').append($('<li>').text(msg + ' joined'));
          });
          socket.on('leave', function (msg) {
            $('#clients').append($('<li>').text(msg + ' left'));
          });
          socket.on('chat message', function(msg) {
            $('#messages').append($('<li>').text(msg.username + ': ' + msg.message));
          });   
        }
      });

      $('form').submit(function(event){
        event.preventDefault();
        socket.emit('chat message', $('#m').val(), $('#recipient_user').val());
        $('#m').val('');
        $('#recipient_user').val('');
        return false;
      });

      $('#createBtn').click(function () {
        console.log('create button clicked');
      });

    </script>

  </body>
</html>